<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Recall WI — Oficial (Cael Theme)</title>
<style>
  :root{
    --bg:#0f1114; --panel:#15181b; --muted:#9aa4ad; --accent:#00d1ff;
    --gold:#ffd700; --purple:#a44bff; --orange:#ff7b00;
    --card:#1b1f23; --glass: rgba(255,255,255,0.03); --text:#e9eef2;
    --cael-bg-start:#0b0710; --cael-bg-end:#1b0830;
    --modal-bg: rgba(2,6,10,0.7);
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0;font-family:Inter,system-ui,-apple-system,"Segoe UI",Roboto,Arial;
    color:var(--text); background:linear-gradient(180deg,var(--cael-bg-start),var(--cael-bg-end));
    min-height:100vh; -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
    transition: background 450ms ease, color 350ms ease;
  }
  header{display:flex;align-items:center;justify-content:space-between;padding:14px 18px;background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(0,0,0,0.12));border-bottom:1px solid rgba(255,255,255,0.03);position:sticky;top:0;z-index:40}
  .brand{display:flex;gap:12px;align-items:center}
  .logo{width:64px;height:64px;border-radius:12px;background:linear-gradient(135deg,#ffd700,#ff8a00);display:flex;align-items:center;justify-content:center;font-weight:900;color:#021;font-size:22px;box-shadow:0 10px 40px rgba(0,0,0,0.5)}
  nav{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
  .navbtn{padding:8px 12px;border-radius:10px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:var(--text);cursor:pointer;font-weight:700}
  .navbtn.active{outline:2px solid var(--gold); box-shadow:0 6px 18px rgba(0,0,0,0.35)}
  .controls{display:flex;gap:8px;align-items:center}
  main{padding:20px;max-width:1180px;margin:18px auto}
  .panel{background:var(--panel);border-radius:14px;padding:18px;margin-bottom:18px;border:1px solid rgba(255,255,255,0.02);box-shadow:0 12px 40px rgba(0,0,0,0.5)}
  .group-title{font-size:18px;color:var(--gold);margin-bottom:10px;font-weight:900}
  .small{font-size:13px;color:var(--muted)}
  .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:12px}
  .card{background:var(--card);padding:14px;border-radius:12px;border:1px solid rgba(255,255,255,0.03)}
  .char-name{display:flex;justify-content:space-between;align-items:center;gap:8px;cursor:pointer;padding:8px;border-radius:8px}
  .char-name:hover{background:rgba(255,255,255,0.02)}
  .char-ability{display:none;margin-top:10px;padding:12px;background:rgba(0,0,0,0.06);border-radius:8px}
  .tag{padding:6px 8px;border-radius:8px;font-weight:800;font-size:12px}
  .comum{background:rgba(255,255,255,0.03);color:#ddd}
  .raro{background:rgba(0,123,255,0.06);color:var(--accent)}
  .epico{background:rgba(164,75,255,0.06);color:var(--purple)}
  .lendario{background:linear-gradient(90deg,#ffd70020,#ff9a0020);color:var(--gold)}
  .shop-line{display:flex;justify-content:space-between;align-items:center;padding:8px;border-radius:8px}
  .old-price{text-decoration:line-through;color:#ffb3a3;margin-right:8px;font-size:13px;opacity:0.9}
  .new-price{color:var(--gold);font-weight:900}
  table{width:100%;border-collapse:collapse}
  th,td{padding:10px;border:1px solid rgba(255,255,255,0.03);text-align:left}
  th{background:rgba(255,255,255,0.02)}
  .hidden{display:none}
  .btn{padding:8px 12px;border-radius:10px;border:none;background:var(--gold);color:#021;font-weight:800;cursor:pointer}
  .danger{background:#ff6b6b;color:#fff}
  .hero-banner{border-radius:12px;padding:18px;margin-bottom:12px;background:linear-gradient(90deg, rgba(255,255,255,0.02), rgba(0,0,0,0.06)); display:flex;align-items:center;justify-content:space-between;gap:12px}
  .hero-left{max-width:70%}
  .hero-title{font-size:22px;font-weight:900;color:var(--gold)}
  .hero-desc{color:var(--muted);font-size:13px;margin-top:6px}
  .event-pill{padding:6px 10px;border-radius:8px;font-weight:800;background:rgba(255,255,255,0.03)}
  .rarity-block{margin-top:12px;border-radius:10px;padding:12px;background:rgba(255,255,255,0.02);border:1px solid rgba(255,255,255,0.02)}
  .rarity-title{font-weight:900;margin-bottom:8px}
  .subtype-title{font-weight:800;margin-top:6px;margin-bottom:6px}
  /* Modal styles */
  .modal-root{position:fixed;inset:0;display:none;align-items:center;justify-content:center;z-index:120}
  .modal-overlay{position:absolute;inset:0;background:var(--modal-bg)}
  .modal-card{position:relative;z-index:121;width:min(720px,96vw);background:var(--panel);border-radius:12px;padding:18px;border:1px solid rgba(255,255,255,0.04);box-shadow:0 20px 60px rgba(0,0,0,0.6)}
  .modal-head{display:flex;justify-content:space-between;align-items:center;gap:8px}
  .modal-title{font-weight:900;font-size:18px}
  .close-btn{background:transparent;border:1px solid rgba(255,255,255,0.04);padding:6px 10px;border-radius:8px;cursor:pointer;color:var(--muted)}
  .modal-body{margin-top:12px}
  .line{margin:6px 0}
  @media (max-width:820px){ .hero-left{max-width:100%} main{padding:12px} header{flex-direction:column;gap:8px;align-items:flex-start} .modal-card{width:92vw} }
</style>
</head>
<body data-theme="dark">
<header>
  <div class="brand">
    <div class="logo" id="logoBox">CAEL</div>
    <div>
      <h1 style="margin:0">Recall WI</h1>
      <div class="small">Tudo que você precisa saber do Recall — Tema: Cael</div>
    </div>
  </div>

  <nav aria-label="Navegação principal">
    <button class="navbtn active" data-section="characters">Personagens</button>
    <button class="navbtn" data-section="shop">Loja</button>
    <button class="navbtn" data-section="money">Economia</button>
    <button class="navbtn" data-section="tracker">Lista secreta</button>
    <button class="navbtn" data-section="trios">Tríades</button>
    <button class="navbtn" data-section="updates">Atualizações</button>
  </nav>

  <div class="controls">
    <button id="themeBtn" class="navbtn">Mudar tema</button>
  </div>
</header>

<main>
  <div class="hero-banner panel" id="hero">
    <div class="hero-left">
      <div class="hero-title">Recall WI — Tema: Cael</div>
      <div class="hero-desc">Este index está focado no tema do Cael (efeitos visuais e badge). Painel de eventos removido nesta versão pública.</div>
    </div>
    <div style="text-align:right">
      <div id="activeEventLabel" class="event-pill">Cael Theme</div>
      <div class="notice" id="activeEventInfo">Visuais aplicados: logo dourada, fundo temporal.</div>
    </div>
  </div>

  <!-- Characters -->
  <section id="characters" class="panel"></section>

  <!-- Shop -->
  <section id="shop" class="panel hidden"></section>

  <!-- Money -->
  <section id="money" class="panel hidden">
    <div class="group-title">Como ganhar Essence</div>
    <div class="small">Ações e recompensas</div>
    <table style="margin-top:10px">
      <thead><tr><th>Ação</th><th>Essence</th></tr></thead>
      <tbody id="moneyTableBody"></tbody>
    </table>
  </section>

  <!-- Tracker -->
  <section id="tracker" class="panel hidden"></section>

  <!-- Trios -->
  <section id="trios" class="panel hidden">
    <div class="group-title">Tríades</div>
    <div class="small">Cada personagem pertence a uma tríade — ??? indica vaga.</div>
    <div id="trioGrid" class="grid" style="margin-top:12px"></div>
  </section>

  <!-- Updates -->
  <section id="updates" class="panel hidden"></section>
</main>

<!-- Modal (central) - usado apenas na aba Personagens -->
<div id="charModal" class="modal-root" role="dialog" aria-hidden="true">
  <div class="modal-overlay" id="modalOverlay"></div>
  <div class="modal-card" role="document" aria-labelledby="modalTitle">
    <div class="modal-head">
      <div id="modalTitle" class="modal-title">Nome — Subtítulo</div>
      <div>
        <button class="close-btn" id="modalClose">Fechar</button>
      </div>
    </div>
    <div class="modal-body" id="modalBody">
      <!-- preenchido dinamicamente -->
      <div class="line"><strong>Habilidade:</strong> ...</div>
      <div class="line"><strong>EN:</strong> ...</div>
      <div class="line"><strong>PT:</strong> ...</div>
      <div class="line small" style="margin-top:10px;color:var(--muted)">Clique fora ou em "Fechar" para sair.</div>
    </div>
  </div>
</div>

<footer style="position:relative">Recall WI — Tema Cael aplicado. Versão pública sem painel de eventos.</footer>

<script>
/* -------------------------
   Atualizações aplicadas:
   - TRACKER_PASSWORD = "BATATA"
   - Salya adicionada (raro)
   - Umbra, Nyra, Seraphina = grátis (price: 0)
   - Loja mostra só nome/raridade/preço e separa por tipo
   - Personagens: clicar abre modal central com habilidade + frases EN/PT
   - Updates ordenadas v1.6 -> v1.0
   ------------------------- */

document.addEventListener('DOMContentLoaded', () => {
  const TRACKER_PASSWORD = "BATATA";

  const characters = [
    {key:"Seraphina", display:"Seraphina — The Healer", type:"Sobrevivente", rarity:"comum", oldPrice:0, price:0, ability:"Revive 1 jogador eliminado (1x).", phraseEN:"Rise again!", phrasePT:"Levante-se de novo!"},
    {key:"Nyra", display:"Nyra — The Swift", type:"Sobrevivente", rarity:"comum", oldPrice:0, price:0, ability:"Escapa de 1 captura (1x).", phraseEN:"Too fast for you!", phrasePT:"Rápida demais pra você!"},
    {key:"Gideon", display:"Gideon — The Guardian", type:"Sobrevivente", rarity:"raro", oldPrice:1000, price:1000, ability:"Protege alguém de 1 ataque (escudo 10s).", phraseEN:"Stay behind me!", phrasePT:"Fiquem atrás de mim!"},
    {key:"Aether", display:"Aether — The Watcher", type:"Sobrevivente", rarity:"raro", oldPrice:1000, price:1000, ability:"Pergunta ao assassino o próximo alvo (1x).", phraseEN:"Who’s your next target?", phrasePT:"Qual é o seu próximo alvo?"},
    {key:"Salya", display:"Salya — A Calmaria", type:"Sobrevivente", rarity:"raro", oldPrice:1200, price:1200, ability:"Trégua — O assassino não pode levantar a arma por 3 segundos, mas ainda pode andar.", phraseEN:"Peace… even if brief.", phrasePT:"Paz… mesmo que curta."},
    {key:"Elara", display:"Elara — The Strategist", type:"Sobrevivente", rarity:"epico", oldPrice:1600, price:1600, ability:"Pode correr duas vezes seguidas sem ser pega (1x).", phraseEN:"Double move!", phrasePT:"Movimento duplo!"},
    {key:"Orion", display:"Orion — The Illusionist", type:"Sobrevivente", rarity:"epico", oldPrice:1700, price:1700, ability:"Diz 'Illusion!' → assassino deve perseguir outro alvo por 10s (1x).", phraseEN:"Can you catch a shadow of me?", phrasePT:"Consegue pegar só minha sombra?"},
    {key:"Liora", display:"Liora — The Veiled", type:"Sobrevivente", rarity:"lendario", oldPrice:2600, price:2600, ability:"Faz assassino contar 8s parado (1x).", phraseEN:"Now you forget me…", phrasePT:"Agora você me esquece…"},
    {key:"Marin", display:"Marin — The Timebinder", type:"Sobrevivente", rarity:"lendario", oldPrice:2700, price:2700, ability:"Ativa 'Time Snare': assassino NÃO PODE CORRER 5s (1x).", phraseEN:"Slow down, time obeys me!", phrasePT:"Diminua, o tempo me obedece!"},
    {key:"Cael", display:"Cael — The Defier", type:"Sobrevivente", rarity:"lendario", oldPrice:2200, price:2200, ability:"Ao ser alvo: assassino NÃO PODE ATACAR por 2s e NÃO PODE CORRER por 8s (1x).", phraseEN:"Your turn to run.", phrasePT:"Agora é você quem corre."},
    {key:"Umbra", display:"Umbra — The Shadow", type:"Assassino", rarity:"comum", oldPrice:0, price:0, ability:"Habilidade ativa somente se tentar pegar e falhar (1x).", phraseEN:"Shadow strike!", phrasePT:"Golpe das sombras!"},
    {key:"Darius", display:"Darius — The Hunter", type:"Assassino", rarity:"raro", oldPrice:800, price:800, ability:"Marked: bloqueia habilidades do alvo por 15s (1x).", phraseEN:"Marked!", phrasePT:"Marcado!"},
    {key:"Echo", display:"Echo — The Returned", type:"Assassino", rarity:"epico", oldPrice:1800, price:1800, ability:"Anula 1 poder usado contra ele (1x).", phraseEN:"Echo!", phrasePT:"Eco!"},
    {key:"Requiem", display:"Requiem — The Reaper", type:"Assassino", rarity:"lendario", oldPrice:3000, price:3000, ability:"Local da morte se torna letal por 15s (1x).", phraseEN:"Death remains...", phrasePT:"A morte permanece..."}
  ];

  const moneyTable = [
    {action:"Sobrevive até o fim", value:"+50E"},
    {action:"Revive alguém", value:"+25E"},
    {action:"Usa habilidade com sucesso", value:"+20E"},
    {action:"Morre antes de 2min", value:"+10E"},
    {action:"Morre depois de 2min", value:"+30E"},
    {action:"Assassino elimina alguém", value:"+20E"},
    {action:"Assassino vence partida", value:"+100E"},
    {action:"Respeita as regras", value:"+5E"},
    {action:"Melhor da rodada", value:"+25E"}
  ];

  const trios = [
    {title:"Tríade da Vida", desc:"Cura, proteção e resiliência", members:["Seraphina","Gideon","Requiem"]},
    {title:"Tríade da Mente", desc:"Observação, estratégia e previsão", members:["Aether","Elara","Orion"]},
    {title:"Tríade da Velocidade", desc:"Movimento, reflexo e precisão", members:["Nyra","Echo","Darius"]},
    {title:"Tríade das Sombras", desc:"Engano, resistência e retribuição (Mestre do Umbra chegando)", members:["Umbra","Liora","???"]},
    {title:"Tríade do Tempo", desc:"Controle temporal e manipulação", members:["Marin","Cael","Orion"]}
  ];

  /* HELPERS */
  function $(sel){return document.querySelector(sel)}
  function $all(sel){return Array.from(document.querySelectorAll(sel))}

  /* NAV wiring */
  $all('.navbtn').forEach(btn=>{
    btn.addEventListener('click', ()=> {
      $all('.navbtn').forEach(b=>b.classList.remove('active'));
      btn.classList.add('active');
      const sec = btn.getAttribute('data-section');
      showSection(sec);
    });
  });
  function showSection(id){
    ['characters','shop','money','tracker','trios','updates'].forEach(s=>{
      const el = document.getElementById(s);
      if(!el) return;
      el.classList.toggle('hidden', s !== id);
    });
    if(id === 'characters') renderCharacters();
    if(id === 'shop') renderShop();
    if(id === 'money') renderMoney();
    if(id === 'tracker') renderTracker();
    if(id === 'trios') renderTrios();
    if(id === 'updates') renderUpdates();
  }

  /* MODAL logic (central) */
  const modalRoot = $('#charModal');
  const modalOverlay = $('#modalOverlay');
  const modalClose = $('#modalClose');
  const modalTitle = $('#modalTitle');
  const modalBody = $('#modalBody');

  function openCharModal(ch){
    modalTitle.textContent = ch.display;
    // build body content
    modalBody.innerHTML = `
      <div class="line"><strong>Raridade:</strong> ${ch.rarity.toUpperCase()} • <strong>Tipo:</strong> ${ch.type}</div>
      <div class="line"><strong>Habilidade:</strong> ${ch.ability}</div>
      <div class="line"><strong>EN:</strong> ${ch.phraseEN}</div>
      <div class="line"><strong>PT:</strong> ${ch.phrasePT}</div>
      <div class="line small" style="margin-top:10px;color:var(--muted)">Fechar: Esc / clicar fora / botão Fechar.</div>
    `;
    modalRoot.style.display = 'flex';
    modalRoot.setAttribute('aria-hidden','false');
    // trap focus could be added; esc closes
    document.addEventListener('keydown', escHandler);
  }
  function closeCharModal(){
    modalRoot.style.display = 'none';
    modalRoot.setAttribute('aria-hidden','true');
    document.removeEventListener('keydown', escHandler);
  }
  function escHandler(e){
    if(e.key === 'Escape') closeCharModal();
  }
  modalOverlay.addEventListener('click', closeCharModal);
  modalClose.addEventListener('click', closeCharModal);

  /* RENDER CHARACTERS (cards) */
  function renderCharacters(){
    const container = $('#characters');
    container.innerHTML = '<div class="group-title">Personagens</div><div class="small">Clique no NOME para ver habilidade e falas (EN / PT).</div><div class="grid" id="charactersGrid" style="margin-top:12px"></div>';
    const grid = $('#charactersGrid');
    grid.innerHTML = '';

    // Survivors block
    const survivors = characters.filter(c=>c.type === "Sobrevivente");
    if(survivors.length){
      const block = document.createElement('div'); block.className='card'; block.style.gridColumn = '1 / -1';
      block.innerHTML = `<div style="font-weight:900">Sobreviventes</div><div class="small" style="margin-top:6px">Personagens que defendem e ajudam.</div>`;
      grid.appendChild(block);
      survivors.forEach(ch=> grid.appendChild(createCharCard(ch)));
    }

    // Killers block
    const killers = characters.filter(c=>c.type === "Assassino");
    if(killers.length){
      const block = document.createElement('div'); block.className='card'; block.style.gridColumn = '1 / -1';
      block.innerHTML = `<div style="font-weight:900">Assassinos</div><div class="small" style="margin-top:6px">Personagens cujo objetivo é caçar.</div>`;
      grid.appendChild(block);
      killers.forEach(ch=> grid.appendChild(createCharCard(ch)));
    }
  }

  function createCharCard(ch){
    const card = document.createElement('div'); card.className = 'card';
    // In "Personagens" we show the clickable name (opens modal) and hidden ability (not shown here)
    const header = document.createElement('div'); header.className = 'char-name';
    // Make the left part a button-like element for accessibility
    const left = document.createElement('div');
    left.innerHTML = `<button class="navbtn" style="padding:6px 10px;border-radius:8px;font-weight:800;border:1px solid rgba(255,255,255,0.03);background:transparent;color:var(--text);cursor:pointer">${ch.display}</button>`;
    // right side: rarity + type
    const right = document.createElement('div'); right.className = 'small'; right.innerHTML = `<span class="tag ${ch.rarity}">${ch.rarity.toUpperCase()}</span> • ${ch.type}`;
    header.appendChild(left); header.appendChild(right);

    // clicking the left button opens the modal with details
    left.querySelector('button').addEventListener('click', ()=> openCharModal(ch));

    // optional: also add keyboard accessibility
    left.querySelector('button').addEventListener('keydown', (e)=> { if(e.key === 'Enter' || e.key === ' ') { e.preventDefault(); openCharModal(ch); } });

    card.appendChild(header);
    return card;
  }

  /* RENDER SHOP: apenas nome, raridade e preço; separado por tipo */
  function renderShop(){
    const area = $('#shop'); area.innerHTML = '<div class="group-title">Loja</div><div class="small">Preços base (sem promoções). Umbra, Nyra e Seraphina são sempre GRÁTIS.</div>';
    const wrapper = document.createElement('div');

    // Helper to create blocks by type
    function createTypeBlock(type){
      const block = document.createElement('div'); block.className = 'rarity-block';
      block.innerHTML = `<div class="rarity-title">${type}</div>`;
      // group by rarity order: comum, raro, epico, lendario
      const rarities = ['comum','raro','epico','lendario'];
      rarities.forEach(r => {
        const list = characters.filter(c => c.type === type && c.rarity === r);
        if(!list.length) return;
        const sub = document.createElement('div');
        sub.innerHTML = `<div class="subtype-title">${r.toUpperCase()}</div>`;
        list.forEach(ch => {
          const priceText = (ch.price === 0 || ch.price === 0) ? '<strong>GRÁTIS</strong>' : `${ch.price}E`;
          const row = document.createElement('div'); row.className = 'shop-line';
          row.innerHTML = `<div style="font-weight:800">${ch.display}</div><div class="small">${priceText}</div>`;
          sub.appendChild(row);
        });
        block.appendChild(sub);
      });
      return block;
    }

    wrapper.appendChild(createTypeBlock('Sobrevivente'));
    wrapper.appendChild(createTypeBlock('Assassino'));
    area.appendChild(wrapper);
  }

  /* MONEY */
  function renderMoney(){
    const tbody = $('#moneyTableBody'); tbody.innerHTML = '';
    moneyTable.forEach(row=>{
      const tr = document.createElement('tr'); tr.innerHTML = `<td>${row.action}</td><td>${row.value}</td>`;
      tbody.appendChild(tr);
    });
  }

  /* TRACKER (protected com senha) */
  let players = JSON.parse(localStorage.getItem('recall_players') || '[]');
  function renderTracker(){
    const area = $('#tracker');
    area.innerHTML = '<div class="group-title">Lista secreta — Controle de Personagens</div><div class="small">Protegido localmente por senha.</div><div id="trackerArea" style="margin-top:12px"><div id="loginDiv"><p class="small">Digite a senha:</p><input id="trackerPass" type="password" placeholder="Senha" style="padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.04)"><button id="trackerLogin" class="btn" style="margin-left:8px">Entrar</button></div><div id="trackerContent" class="hidden" style="margin-top:12px"><div style="overflow:auto"><table id="playerTable"><thead><tr id="playerHeader"><th>Jogador</th></tr></thead><tbody id="playerBody"></tbody></table></div><div style="margin-top:10px;display:flex;gap:8px;flex-wrap:wrap"><button id="addPlayer" class="btn">Adicionar Jogador</button><button id="clearPlayers" class="btn">Limpar lista</button><button id="exportPlayers" class="btn danger">Exportar (JSON)</button></div></div></div>';
    buildPlayerHeader();

    document.getElementById('trackerLogin').addEventListener('click', ()=> {
      const v = document.getElementById('trackerPass').value;
      if(v === TRACKER_PASSWORD){
        document.getElementById('trackerPass').value = '';
        document.getElementById('loginDiv').style.display = 'none';
        document.getElementById('trackerContent').classList.remove('hidden');
        renderTable();
      } else {
        alert('Senha incorreta!');
      }
    });

    document.getElementById('addPlayer').addEventListener('click', ()=> {
      const name = prompt('Nome do jogador:'); if(!name) return;
      players.push({name, characters:{}}); localStorage.setItem('recall_players', JSON.stringify(players)); renderTable();
    });
    document.getElementById('clearPlayers').addEventListener('click', ()=> {
      if(confirm('Limpar toda a lista local?')){ players=[]; localStorage.setItem('recall_players', JSON.stringify(players)); renderTable(); }
    });
    document.querySelector('.btn.danger')?.addEventListener('click', ()=> {
      const data = JSON.stringify(players,null,2); const blob = new Blob([data],{type:'application/json'}); const url = URL.createObjectURL(blob); const a = document.createElement('a'); a.href = url; a.download = 'recall_players.json'; a.click(); URL.revokeObjectURL(url);
    });
  }
  function buildPlayerHeader(){
    const header = document.getElementById('playerHeader'); header.innerHTML = '<th>Jogador</th>';
    characters.forEach(c=> { const th = document.createElement('th'); th.textContent = c.key; header.appendChild(th); });
  }
  function renderTable(){
    const tbody = document.getElementById('playerBody'); tbody.innerHTML = '';
    players.forEach((p, idx)=>{
      const tr = document.createElement('tr');
      const tdName = document.createElement('td'); tdName.textContent = p.name; tr.appendChild(tdName);
      characters.forEach(ch=>{
        const td = document.createElement('td'); const cb = document.createElement('input'); cb.type='checkbox'; cb.checked = !!p.characters[ch.key];
        cb.addEventListener('change', ()=> { players[idx].characters[ch.key] = cb.checked; localStorage.setItem('recall_players', JSON.stringify(players));});
        td.appendChild(cb); tr.appendChild(td);
      });
      tbody.appendChild(tr);
    });
  }

  /* TRIOS */
  function renderTrios(){
    const grid = $('#trioGrid'); grid.innerHTML = '';
    trios.forEach(t=>{
      const card = document.createElement('div'); card.className = 'card';
      const list = t.members.map(m=> `<li>${m}</li>`).join('');
      card.innerHTML = `<div style="font-weight:900">${t.title}</div><div class="small">${t.desc}</div><div style="margin-top:8px"><ul class="trio-list">${list}</ul></div>`;
      grid.appendChild(card);
    });
  }

  /* UPDATES (ordenado conforme seu pedido) */
  function renderUpdates(){
    const area = $('#updates'); area.innerHTML = '<div class="group-title">Atualizações</div>';
    const list = [
      {title:"V1.6 — Salya update", desc:"Adicionada Salya — A Calmaria (raro). Ajustes de balanceamento e correção de preços."},
      {title:"V1.5 — Halloween e Cael", desc:"Tema Cael refinado; suporte visual de Halloween ajustado."},
      {title:"V1.4 — Requiem", desc:"Adicionado Requiem; mecânicas de zona letal ajustadas."},
      {title:"V1.3 — Marin", desc:"Adicionado Marin — Timebinder; ajustes no tracker."},
      {title:"V1.2 — Liora", desc:"Adicionado Liora — The Veiled; melhorias nas descrições."},
      {title:"V1.1 — Orion", desc:"Adicionado Orion — The Illusionist."},
      {title:"V1.0 — LANÇAMENTO", desc:"Versão inicial do Recall WI."}
    ];
    list.forEach(u=>{ const block = document.createElement('div'); block.className='card'; block.innerHTML = `<div style="font-weight:900">${u.title}</div><div class="small" style="margin-top:8px">${u.desc}</div>`; area.appendChild(block); });
  }

  /* Theme toggle */
  $('#themeBtn').addEventListener('click', ()=>{
    const cur = document.body.getAttribute('data-theme') === 'light' ? 'dark' : 'light';
    document.body.setAttribute('data-theme', cur);
    if(cur === 'light'){
      document.body.style.background = 'linear-gradient(180deg,#f6f7fb,#e8eefc)';
      $('#logoBox').style.background = 'linear-gradient(135deg,#d1b000,#6b3a99)';
      document.querySelectorAll('.card').forEach(c=> c.style.background = '#ffffff');
    } else {
      document.body.style.background = 'linear-gradient(180deg,var(--cael-bg-start),var(--cael-bg-end))';
      $('#logoBox').style.background = 'linear-gradient(135deg,#ffd700,#ff8a00)';
      document.querySelectorAll('.card').forEach(c=> c.style.background = 'var(--card)');
    }
  });

  /* INIT */
  function init(){
    renderCharacters(); renderShop(); renderMoney(); renderTrios(); renderUpdates();
    // money table
    const tbody = document.getElementById('moneyTableBody'); tbody.innerHTML='';
    moneyTable.forEach(r=>{ const tr = document.createElement('tr'); tr.innerHTML = `<td>${r.action}</td><td>${r.value}</td>`; tbody.appendChild(tr); });
    // header badge
    document.getElementById('activeEventLabel').textContent = 'Cael Theme';
    document.getElementById('activeEventInfo').textContent = 'Cael visuals applied: golden logo, temporal background.';
    // nav default
    showSection('characters');
  }
  init();

});
</script>
</body>
</html>

